<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Memphis Poverty Fact Sheet</title>
    <!-- Font Awesome -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
            rel="stylesheet"
    />
    <!-- Google Fonts -->
    <link
            href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
            rel="stylesheet"
    />
    <!-- MDB -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.1.0/mdb.min.css"
            rel="stylesheet"
    />
    <!-- d3.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"
            integrity="sha512-M7nHCiNUOwFt6Us3r8alutZLm9qMt4s9951uo8jqO4UwJ1hziseL6O3ndFyigx6+LREfZqnhHxYjKRJ8ZQ69DQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>
        var rows = [];
        rows['2020'] = [
            {
                "Geography": "United States",
                "Year": 2020,
                "Category": "Overall Poverty Rate",
                "Overall": "12.8%",
                "Non-Hispanic White": "9.3%",
                "Black": "22.1%",
                "Latino or Hispanic": "18.3%",
                "Asian": "10.6%",
                "Native American": ""
            },
            {
                "Geography": "United States",
                "Year": 2020,
                "Category": "Child (Under 18) Poverty Rate",
                "Overall": "17.5%",
                "Non-Hispanic White": "10.6%",
                "Black": "31.8%",
                "Latino or Hispanic": "24.7%",
                "Asian": "10.6%",
                "Native American": ""
            },
            {
                "Geography": "United States",
                "Year": 2020,
                "Category": "Adult (18-64) Poverty Rate",
                "Overall": "12.2%",
                "Non-Hispanic White": "9.8%",
                "Black": "19.1%",
                "Latino or Hispanic": "15.1%",
                "Asian": "10.4%",
                "Native American": ""
            },
            {
                "Geography": "United States",
                "Year": 2020,
                "Category": "Senior (65+) Poverty Rate",
                "Overall": "9.7%",
                "Non-Hispanic White": "7.6%",
                "Black": "17.9%",
                "Latino or Hispanic": "16.7%",
                "Asian": "11.5%",
                "Native American": ""
            },
            {
                "Geography": "Tennessee",
                "Year": 2020,
                "Category": "Overall Poverty Rate",
                "Overall": "14.6%",
                "Non-Hispanic White": "11.6%",
                "Black": "24.3%",
                "Latino or Hispanic": "24.5%",
                "Asian": "10.1%",
                "Native American": ""
            },
            {
                "Geography": "Tennessee",
                "Year": 2020,
                "Category": "Child (Under 18) Poverty Rate",
                "Overall": "20.8%",
                "Non-Hispanic White": "14.4%",
                "Black": "37.3%",
                "Latino or Hispanic": "32.8%",
                "Asian": "8.9%",
                "Native American": ""
            },
            {
                "Geography": "Tennessee",
                "Year": 2020,
                "Category": "Adult (18-64) Poverty Rate",
                "Overall": "13.9%",
                "Non-Hispanic White": "12.0%",
                "Black": "20.4%",
                "Latino or Hispanic": "19.6%",
                "Asian": "10.6%",
                "Native American": ""
            },
            {
                "Geography": "Tennessee",
                "Year": 2020,
                "Category": "Senior (65+) Poverty Rate",
                "Overall": "10.1%",
                "Non-Hispanic White": "8.9%",
                "Black": "17.7%",
                "Latino or Hispanic": "14.4%",
                "Asian": "10.2%",
                "Native American": ""
            },
            {
                "Geography": "Shelby County",
                "Year": 2020,
                "Category": "Overall Poverty Rate",
                "Overall": "19.0%",
                "Non-Hispanic White": "7.8%",
                "Black": "26.2%",
                "Latino or Hispanic": "25.0%",
                "Asian": "10.0%",
                "Native American": ""
            },
            {
                "Geography": "Shelby County",
                "Year": 2020,
                "Category": "Child (Under 18) Poverty Rate",
                "Overall": "29.9%",
                "Non-Hispanic White": "7.1%",
                "Black": "40.8%",
                "Latino or Hispanic": "34.2%",
                "Asian": "7.4%",
                "Native American": ""
            },
            {
                "Geography": "Shelby County",
                "Year": 2020,
                "Category": "Adult (18-64) Poverty Rate",
                "Overall": "16.5%",
                "Non-Hispanic White": "9.1%",
                "Black": "21.4%",
                "Latino or Hispanic": "18.6%",
                "Asian": "8.3%",
                "Native American": ""
            },
            {
                "Geography": "Shelby County",
                "Year": 2020,
                "Category": "Senior (65+) Poverty Rate",
                "Overall": "11.9%",
                "Non-Hispanic White": "5.6%",
                "Black": "18.6%",
                "Latino or Hispanic": "10.6%",
                "Asian": "21.6%",
                "Native American": ""
            },
            {
                "Geography": "City of Memphis",
                "Year": 2020,
                "Category": "Overall Poverty Rate",
                "Overall": "24.6%",
                "Non-Hispanic White": "11.3%",
                "Black": "29.5%",
                "Latino or Hispanic": "29.3%",
                "Asian": "17.1%",
                "Native American": ""
            },
            {
                "Geography": "City of Memphis",
                "Year": 2020,
                "Category": "Child (Under 18) Poverty Rate",
                "Overall": "39.6%",
                "Non-Hispanic White": "11.9%",
                "Black": "45.6%",
                "Latino or Hispanic": "39.7%",
                "Asian": "13.1%",
                "Native American": ""
            },
            {
                "Geography": "City of Memphis",
                "Year": 2020,
                "Category": "Adult (18-64) Poverty Rate",
                "Overall": "21.1%",
                "Non-Hispanic White": "13.1%",
                "Black": "24.4%",
                "Latino or Hispanic": "21.8%",
                "Asian": "15.4%",
                "Native American": ""
            },
            {
                "Geography": "City of Memphis",
                "Year": 2020,
                "Category": "Senior (65+) Poverty Rate",
                "Overall": "15.3%",
                "Non-Hispanic White": "7.4%",
                "Black": "20.4%",
                "Latino or Hispanic": "13.4%",
                "Asian": "26.4%",
                "Native American": ""
            },
            {
                "Geography": "Memphis MSA",
                "Year": 2020,
                "Category": "Overall Poverty Rate",
                "Overall": "17.3%",
                "Non-Hispanic White": "8.1%",
                "Black": "25.3%",
                "Latino or Hispanic": "24.5%",
                "Asian": "9.3%",
                "Native American": ""
            },
            {
                "Geography": "Memphis MSA",
                "Year": 2020,
                "Category": "Child (Under 18) Poverty Rate",
                "Overall": "27.2%",
                "Non-Hispanic White": "9.2%",
                "Black": "39.0%",
                "Latino or Hispanic": "33.7%",
                "Asian": "6.8%",
                "Native American": ""
            },
            {
                "Geography": "Memphis MSA",
                "Year": 2020,
                "Category": "Adult (18-64) Poverty Rate",
                "Overall": "15.2%",
                "Non-Hispanic White": "8.9%",
                "Black": "20.7%",
                "Latino or Hispanic": "18.7%",
                "Asian": "7.9%",
                "Native American": ""
            },
            {
                "Geography": "Memphis MSA",
                "Year": 2020,
                "Category": "Senior (65+) Poverty Rate",
                "Overall": "10.8%",
                "Non-Hispanic White": "5.7%",
                "Black": "18.4%",
                "Latino or Hispanic": "8.9%",
                "Asian": "19.0%",
                "Native American": ""
            }
        ];
        rows['2021'] = [
            {
                "Geography": "United States",
                "Year": 2021,
                "Category": "Overall Poverty Rate",
                "Overall": "12.8%",
                "Non-Hispanic White": "9.5%",
                "Black": "21.8%",
                "Latino or Hispanic": "17.5%",
                "Asian": "10.2%",
                "Native American": "21.3%"
            },
            {
                "Geography": "United States",
                "Year": 2021,
                "Category": "Child (Under 18) Poverty Rate",
                "Overall": "16.9%",
                "Non-Hispanic White": "10.6%",
                "Black": "31.0%",
                "Latino or Hispanic": "23.2%",
                "Asian": "10.3%",
                "Native American": "27.6%"
            },
            {
                "Geography": "United States",
                "Year": 2021,
                "Category": "Adult (18-64) Poverty Rate",
                "Overall": "11.9%",
                "Non-Hispanic White": "9.6%",
                "Black": "19.0%",
                "Latino or Hispanic": "14.7%",
                "Asian": "9.6%",
                "Native American": "19.2%"
            },
            {
                "Geography": "United States",
                "Year": 2021,
                "Category": "Senior (65+) Poverty Rate",
                "Overall": "10.3%",
                "Non-Hispanic White": "8.2%",
                "Black": "17.6%",
                "Latino or Hispanic": "17.7%",
                "Asian": "12.9%",
                "Native American": "17.5%"
            },
            {
                "Geography": "Tennessee",
                "Year": 2021,
                "Category": "Overall Poverty Rate",
                "Overall": "13.6%",
                "Non-Hispanic White": "11.1%",
                "Black": "22.2%",
                "Latino or Hispanic": "20.2%",
                "Asian": "11.1%",
                "Native American": "15.7%"
            },
            {
                "Geography": "Tennessee",
                "Year": 2021,
                "Category": "Child (Under 18) Poverty Rate",
                "Overall": "18.1%",
                "Non-Hispanic White": "12.6%",
                "Black": "31.9%",
                "Latino or Hispanic": "26.4%",
                "Asian": "11.7%",
                "Native American": "18.2%"
            },
            {
                "Geography": "Tennessee",
                "Year": 2021,
                "Category": "Adult (18-64) Poverty Rate",
                "Overall": "13.0%",
                "Non-Hispanic White": "11.3%",
                "Black": "19.3%",
                "Latino or Hispanic": "16.1%",
                "Asian": "10.4%",
                "Native American": "15.1%"
            },
            {
                "Geography": "Tennessee",
                "Year": 2021,
                "Category": "Senior (65+) Poverty Rate",
                "Overall": "10.2%",
                "Non-Hispanic White": "8.9%",
                "Black": "17.9%",
                "Latino or Hispanic": "18.5%",
                "Asian": "14.3%",
                "Native American": "12.3%"
            },
            {
                "Geography": "Shelby County",
                "Year": 2021,
                "Category": "Overall Poverty Rate",
                "Overall": "17.9%",
                "Non-Hispanic White": "7.6%",
                "Black": "23.8%",
                "Latino or Hispanic": "27.2%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "Shelby County",
                "Year": 2021,
                "Category": "Child (Under 18) Poverty Rate",
                "Overall": "24.1%",
                "Non-Hispanic White": "4.4%",
                "Black": "33.0%",
                "Latino or Hispanic": "30.8%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "Shelby County",
                "Year": 2021,
                "Category": "Adult (18-64) Poverty Rate",
                "Overall": "16.1%",
                "Non-Hispanic White": "8.1%",
                "Black": "20.5%",
                "Latino or Hispanic": "23.7%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "Shelby County",
                "Year": 2021,
                "Category": "Senior (65+) Poverty Rate",
                "Overall": "14.6%",
                "Non-Hispanic White": "9.0%",
                "Black": "19.8%",
                "Latino or Hispanic": "35.0%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "City of Memphis",
                "Year": 2021,
                "Category": "Overall Poverty Rate",
                "Overall": "22.6%",
                "Non-Hispanic White": "10.3%",
                "Black": "26.5%",
                "Latino or Hispanic": "",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "City of Memphis",
                "Year": 2021,
                "Category": "Child (Under 18) Poverty Rate",
                "Overall": "32.7%",
                "Non-Hispanic White": "5.8%",
                "Black": "37.6%",
                "Latino or Hispanic": "",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "City of Memphis",
                "Year": 2021,
                "Category": "Adult (18-64) Poverty Rate",
                "Overall": "19.7%",
                "Non-Hispanic White": "10.8%",
                "Black": "22.8%",
                "Latino or Hispanic": "",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "City of Memphis",
                "Year": 2021,
                "Category": "Senior (65+) Poverty Rate",
                "Overall": "16.8%",
                "Non-Hispanic White": "5.2%",
                "Black": "20.8%",
                "Latino or Hispanic": "",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "Memphis MSA",
                "Year": 2021,
                "Category": "Overall Poverty Rate",
                "Overall": "16.9%",
                "Non-Hispanic White": "7.7%",
                "Black": "23.9%",
                "Latino or Hispanic": "28.2%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "Memphis MSA",
                "Year": 2021,
                "Category": "Child (Under 18) Poverty Rate",
                "Overall": "22.9%",
                "Non-Hispanic White": "5.9%",
                "Black": "32.5%",
                "Latino or Hispanic": "32.6%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "Memphis MSA",
                "Year": 2021,
                "Category": "Adult (18-64) Poverty Rate",
                "Overall": "15.2%",
                "Non-Hispanic White": "8.0%",
                "Black": "20.7%",
                "Latino or Hispanic": "24.2%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Geography": "Memphis MSA",
                "Year": 2021,
                "Category": "Senior (65+) Poverty Rate",
                "Overall": "13.7%",
                "Non-Hispanic White": "8.8%",
                "Black": "20.3%",
                "Latino or Hispanic": "35.4%",
                "Asian": "",
                "Native American": ""
            }
        ];
        rows['2022'] = [
            {
                "Category": "Overall Poverty Rate",
                "Year": 2022,
                "Geography": "United States",
                "Overall": "12.6%",
                "Non-Hispanic White": "9.9%",
                "Black": "21.3%",
                "Latino or Hispanic": "16.8%",
                "Asian": "10.1%",
                "Native American": "21.7%"
            },
            {
                "Category": "Child (Under 18) Poverty Rate",
                "Year": 2022,
                "Geography": "United States",
                "Overall": "16.3%",
                "Non-Hispanic White": "10.2%",
                "Black": "29.8%",
                "Latino or Hispanic": "22.0%",
                "Asian": "10.1%",
                "Native American": "28.7%"
            },
            {
                "Category": "Adult (18-64) Poverty Rate",
                "Year": 2022,
                "Geography": "United States",
                "Overall": "11.7%",
                "Non-Hispanic White": "9.5%",
                "Black": "18.6%",
                "Latino or Hispanic": "14.1%",
                "Asian": "9.3%",
                "Native American": "19.2%"
            },
            {
                "Category": "Senior (65+) Poverty Rate",
                "Year": 2022,
                "Geography": "United States",
                "Overall": "10.9%",
                "Non-Hispanic White": "8.8%",
                "Black": "18.6%",
                "Latino or Hispanic": "18.2%",
                "Asian": "13.5%",
                "Native American": "19.8%"
            },
            {
                "Category": "Overall Poverty Rate",
                "Year": 2022,
                "Geography": "Tennessee",
                "Overall": "13.3%",
                "Non-Hispanic White": "10.9%",
                "Black": "21.0%",
                "Latino or Hispanic": "20.0%",
                "Asian": "8.7%",
                "Native American": ""
            },
            {
                "Category": "Child (Under 18) Poverty Rate",
                "Year": 2022,
                "Geography": "Tennessee",
                "Overall": "17.6%",
                "Non-Hispanic White": "12.4%",
                "Black": "30.2%",
                "Latino or Hispanic": "25.6%",
                "Asian": "11.8%",
                "Native American": ""
            },
            {
                "Category": "Adult (18-64) Poverty Rate",
                "Year": 2022,
                "Geography": "Tennessee",
                "Overall": "12.4%",
                "Non-Hispanic White": "10.8%",
                "Black": "17.9%",
                "Latino or Hispanic": "16.8%",
                "Asian": "7.7%",
                "Native American": ""
            },
            {
                "Category": "Senior (65+) Poverty Rate",
                "Year": 2022,
                "Geography": "Tennessee",
                "Overall": "11.0%",
                "Non-Hispanic White": "10.0%",
                "Black": "18.1%",
                "Latino or Hispanic": "12.6%",
                "Asian": "9.5%",
                "Native American": ""
            },
            {
                "Category": "Overall Poverty Rate",
                "Year": 2022,
                "Geography": "Shelby County",
                "Overall": "16.5%",
                "Non-Hispanic White": "8.1%",
                "Black": "21.7%",
                "Latino or Hispanic": "19.4%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Child (Under 18) Poverty Rate",
                "Year": 2022,
                "Geography": "Shelby County",
                "Overall": "23.7%",
                "Non-Hispanic White": "7.2%",
                "Black": "30.3%",
                "Latino or Hispanic": "25.8%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Adult (18-64) Poverty Rate",
                "Year": 2022,
                "Geography": "Shelby County",
                "Overall": "14.5%",
                "Non-Hispanic White": "7.9%",
                "Black": "18.8%",
                "Latino or Hispanic": "14.1%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Senior (65+) Poverty Rate",
                "Year": 2022,
                "Geography": "Shelby County",
                "Overall": "12.8%",
                "Non-Hispanic White": "8.2%",
                "Black": "17.9%",
                "Latino or Hispanic": "20.9%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Overall Poverty Rate",
                "Year": 2022,
                "Geography": "City of Memphis",
                "Overall": "21.4%",
                "Non-Hispanic White": "12.2%",
                "Black": "24.7%",
                "Latino or Hispanic": "22.7%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Child (Under 18) Poverty Rate",
                "Year": 2022,
                "Geography": "City of Memphis",
                "Overall": "32.7%",
                "Non-Hispanic White": "10.4%",
                "Black": "36.3%",
                "Latino or Hispanic": "30.6%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Adult (18-64) Poverty Rate",
                "Year": 2022,
                "Geography": "City of Memphis",
                "Overall": "18.3%",
                "Non-Hispanic White": "12.3%",
                "Black": "21.2%",
                "Latino or Hispanic": "16.3%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Senior (65+) Poverty Rate",
                "Year": 2022,
                "Geography": "City of Memphis",
                "Overall": "15.7%",
                "Non-Hispanic White": "11.3%",
                "Black": "18.3%",
                "Latino or Hispanic": "23.9%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Overall Poverty Rate",
                "Year": 2022,
                "Geography": "Memphis MSA",
                "Overall": "15.7%",
                "Non-Hispanic White": "8.2%",
                "Black": "22.4%",
                "Latino or Hispanic": "17.5%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Child (Under 18) Poverty Rate",
                "Year": 2022,
                "Geography": "Memphis MSA",
                "Overall": "22.4%",
                "Non-Hispanic White": "7.6%",
                "Black": "32.0%",
                "Latino or Hispanic": "23.7%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Adult (18-64) Poverty Rate",
                "Year": 2022,
                "Geography": "Memphis MSA",
                "Overall": "13.8%",
                "Non-Hispanic White": "8.0%",
                "Black": "19.1%",
                "Latino or Hispanic": "12.9%",
                "Asian": "",
                "Native American": ""
            },
            {
                "Category": "Senior (65+) Poverty Rate",
                "Year": 2022,
                "Geography": "Memphis MSA",
                "Overall": "12.2%",
                "Non-Hispanic White": "8.0%",
                "Black": "18.3%",
                "Latino or Hispanic": "17.0%",
                "Asian": "",
                "Native American": ""
            }
        ];
    </script>
    <style>
        h1 {
            text-align: center;
        }
        .lineGraph {
            width: 45%;
            float: left;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
        <a class="navbar-brand" href="https://www.gmbs-consulting.com/">GMBS Consulting</a>
        <button
                data-mdb-collapse-init
                class="navbar-toggler"
                type="button"
                data-mdb-target="#navbarNav"
                aria-controls="navbarNav"
                aria-expanded="false"
                aria-label="Toggle navigation"
        >
            <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../index.html" data-text="home">home</a></li>
                <li class="nav-item"><a class="nav-link" href="#" data-text="archives">archives</a></li>
                <li class="nav-item"><a class="nav-link" href="#" data-text="tags">tags</a></li>
                <li class="nav-item"><a class="nav-link" href="#" data-text="categories">categories</a></li>
                <li class="nav-item"><a class="nav-link active" href="./Detailed_Tables.html">Detailed Tables</a></li>
                <li class="nav-item"><a class="nav-link" href="./Table_1.html">Summary Tables</a></li>
                <li class="nav-item"><a class="nav-link" href="./Pie.html">Summary Pie Charts</a></li>
                <li class="nav-item"><a class="nav-link" href="./maps_ZIP.html">Maps</a></li>
            </ul>
        </div>
    </div>
</nav>
<h1 id="pageTitle"></h1>
<label for="year">Year: </label>
<select id="year" onchange="update()">
    <option value="2020" selected="selected">2020</option>
    <option value="2021">2021</option>
    <option value="2022">2022</option>
</select>
<label for="geography">Geography: </label>
<select id="geography" onchange="update()">
</select>
<table class="table table-striped table-bordered">
    <thead>
    <tr class="table-dark" id="tableHead">
    </tr>
    </thead>
    <tbody id="tableData">
    </tbody>
</table>
<div class="lineGraph" id="myDivAge"></div>
<div class="lineGraph" id="myDivRace"></div>
<!-- MDB -->
<script
        type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.1.0/mdb.umd.min.js"
></script>
<script>
    function onlyUnique(value, index, array) {
        return array.indexOf(value) === index;
    }

    function loadDropdown(yv) {
        let geography = document.getElementById('geography');
        geography.innerHTML = "";
        let geo = rows[yv].map(a => a.Geography);
        let uGeo = geo.filter(onlyUnique);
        uGeo.forEach(g => {
            let el = document.createElement("option");
            el.textContent = g;
            el.value = g;
            geography.appendChild(el);
        })
    }

    function loadTableData(yv, gv) {
        const skip = ['Year', 'Geography'];
        const tableHR = document.getElementById("tableHead");
        tableHR.innerHTML = '';
        const tableD = document.getElementById("tableData");
        tableD.innerHTML = '';
        if (rows[yv][0]) {
            let head = rows[yv][0];
            Object.keys(head).forEach(function (key) {
                if (skip.includes(key)) {
                } else {
                    tableHR.insertCell().outerHTML = "<th scope='col'>" + key + "</th>";
                }
            })
            rows[yv].forEach(data => {
                    let i = 0;
                    if (data.Geography === gv) {
                        let row = tableD.insertRow();
                        Object.keys(data).forEach(function (key) {
                            if (skip.includes(key)) {
                            } else {
                                let cell = row.insertCell();
                                cell.innerHTML = data[key];
                                if (i === 0) {
                                    cell.style.fontWeight = 'bold';
                                }
                                i++;
                            }
                        })
                    }
                }
            )
        }
    }

    function groupBy(xs, key) {
        return xs.reduce(function (rv, x) {
            (rv[x[key]] = rv[x[key]] || []).push(x);
            return rv;
        }, {});
    }

    function loadGraphData(gv = '') {
        if (gv === '') {
            gv = 'United States';
        }
        let allYears = rows.flat();
        let grouped = groupBy(allYears, 'Geography');
        let geoData = grouped[gv];
        return groupBy(geoData, 'Category');
    }


    function makeTraceAge(catListA, data, yearList, gv) {
        let traces = [];
        for (let c of catListA) {
            let dp = data[c].map(a => a.Overall);
            traces.push({
                x: yearList,
                y: dp,
                name: c,
                type: 'line'
            });
        }
        const layout = {
            title: 'Poverty Rates in ' + gv + ' by Age',
            yaxis: {
                title: 'Poverty Rate (%)',
                range: [0, 50]
            },
            xaxis: {
                tickvals: ['2020', '2021', '2022'],
                ticktext: ['2020', '2021', '2022']
            },
            showlegend: true,
            legend: {
                x: 1,
                xanchor: 'right',
                y: 1
            }
        };
        return [traces, layout];
    }

    function makeTraceRace(catListR, data, yearList, gv) {
        let traces = [];
        let over = data["Overall Poverty Rate"];
        let dp = [];
        catListR.forEach(r => {
            dp[r] = [];
            over.forEach(o => {
                dp[r].push(o[r]);
            })
            traces.push({
                x: yearList,
                y: dp[r],
                name: r,
                type: 'line'
            });
        })
        const layout = {
            title: 'Poverty Rates in ' + gv + ' by Race',
            yaxis: {
                title: 'Poverty Rate (%)',
                range: [0, 50]
            },
            xaxis: {
                tickvals: ['2020', '2021', '2022'],
                ticktext: ['2020', '2021', '2022']
            },
            showlegend: true,
            legend: {
                x: 1,
                xanchor: 'right',
                y: 1
            }
        };
        return [traces, layout];
    }

    function makePlotly(gv, yv) {
        let data = loadGraphData(gv);
        const yearList = ['2020', '2021', '2022']
        let catListA = ["Overall Poverty Rate",
            "Child (Under 18) Poverty Rate",
            "Adult (18-64) Poverty Rate",
            "Senior (65+) Poverty Rate"];
        let [tracesA, layoutA] = makeTraceAge(catListA, data, yearList, gv);
        Plotly.newPlot('myDivAge', tracesA, layoutA);
        let catListR = [
            "Overall", "Non-Hispanic White", "Black", "Latino or Hispanic", "Asian", "Native American"
        ];
        let [tracesR, layoutR] = makeTraceRace(catListR, data, yearList, gv);
        Plotly.newPlot('myDivRace', tracesR, layoutR);
        let line = Plotly.d3.selectAll('.xgrid').filter('.crisp').filter(function (d, i) {
            return i === yv
        })
        line.style("stroke", "rgb(255,0,0)")
        line.style("stroke-width", "10px")
    }

    function update() {
        let year = document.getElementById('year');
        let geography = document.getElementById('geography');
        let yv = year.value;
        if (yv === '') {
            yv = 2020;
        }
        let gv = geography.value;
        if (gv === '') {
            gv = 'United States';
        }
        document.getElementById('pageTitle').innerText = 'Poverty Rates in ' + gv
        loadDropdown(yv);
        loadTableData(yv, gv);
        makePlotly(gv, yv);
    }

    update();
</script>
<script
        type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/7.1.0/mdb.umd.min.js"
></script>
</body>
</html>